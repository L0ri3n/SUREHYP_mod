# Quick Start Guide: Process EO1H2020342013284110KF

## âš¡ Fast Track (You're Almost Ready!)

### âœ… What You Already Have
- âœ“ L1R data extracted: `L1R/EO1H2020342013284110KF/`
- âœ“ L1T data (zipped): `L1T/EO1H2020342013284110KF_1T.ZIP`
- âœ“ XML metadata: `Project/eo1_hyp_pub_EO1H2020342013284110KF_SG1_01.xml`

### ğŸš€ 3 Steps to Process

#### Step 1: Convert Metadata (2 minutes)
```bash
cd C:\Lorien\Archivos\TUBAF\1st_Semester\Remote_Sensing\SUREHYP
python create_metadata_EO1H2020342013284110KF.py
```

**Expected output:**
```
âœ“ Appended EO1H2020342013284110KF_SG1_01 to METADATA/METADATA.csv
```

#### Step 2: Update Image Name (1 minute)
Open `process_hyperion.py` and change **line 1051**:
```python
fname = 'EO1H2020342013284110KF'  # Change this line
```

#### Step 3: Run Processing (15-30 minutes)
```bash
python process_hyperion.py
```

---

## ğŸ“Š What the Metadata Script Does

The `create_metadata_EO1H2020342013284110KF.py` script:

### INPUT: XML File
```xml
<eemetadata:metadataField name="Sun Elevation">
    <eemetadata:metadataValue>36.752901</eemetadata:metadataValue>
</eemetadata:metadataField>
<eemetadata:metadataField name="Sun Azimuth">
    <eemetadata:metadataValue>140.392107</eemetadata:metadataValue>
</eemetadata:metadataField>
<!-- ... 30+ more fields ... -->
```

### OUTPUT: CSV Row Added to METADATA.csv
```csv
Entity ID,Sun Elevation,Sun Azimuth,Look Angle,Satellite Inclination,Center Longtude dec,Center Latitude dec,Acquisition Date,Scene Start Time,Scene Stop Time
EO1H2020342013284110KF_SG1_01,36.752901,140.392107,-25.682,98.0,-6.580288,37.555186,2013/10/11,2013:284:10:09:05,2013:284:10:09:19
```

### Why This Matters
The processing code reads `METADATA.csv` to get:
- **Sun angles** â†’ Atmospheric correction
- **Look angles** â†’ Topographic correction
- **Coordinates** â†’ Download DEM from Google Earth Engine
- **Time** â†’ Solar distance, atmospheric water vapor

---

## ğŸ—‚ï¸ File Organization Summary

```
Your Setup (Already Correct âœ“)
â”‚
â”œâ”€â”€ L1R/EO1H2020342013284110KF/              â† Extracted folder
â”‚   â”œâ”€â”€ EO1H2020342013284110KF.L1R           (Radiance data)
â”‚   â”œâ”€â”€ EO1H2020342013284110KF.MET           (Corner coordinates)
â”‚   â””â”€â”€ ...
â”‚
â”œâ”€â”€ L1T/EO1H2020342013284110KF_1T.ZIP        â† Keep as ZIP
â”‚
â”œâ”€â”€ Project/eo1_hyp_pub_...xml               â† XML metadata
â”‚
â””â”€â”€ METADATA/METADATA.csv                     â† Generated by script
```

---

## ğŸ”„ Complete Workflow Diagram

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  START: You Have 3 Files from USGS                          â”‚
â”‚  âœ“ EO1H2020342013284110KF_1R.ZIP                            â”‚
â”‚  âœ“ EO1H2020342013284110KF_1T.ZIP                            â”‚
â”‚  âœ“ eo1_hyp_pub_EO1H2020342013284110KF_SG1_01.xml           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  STEP 0: Organize Files (DONE âœ“)                            â”‚
â”‚  â€¢ Extract L1R to L1R/EO1H2020342013284110KF/               â”‚
â”‚  â€¢ Keep L1T zipped in L1T/                                   â”‚
â”‚  â€¢ Put XML in Project/                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  STEP 1: Convert XML to CSV                                  â”‚
â”‚  Run: python create_metadata_EO1H2020342013284110KF.py      â”‚
â”‚                                                              â”‚
â”‚  Script Actions:                                             â”‚
â”‚  1. Parse XML file                                           â”‚
â”‚  2. Extract 40+ metadata fields                              â”‚
â”‚  3. Format time strings (remove milliseconds)                â”‚
â”‚  4. Create DataFrame with SUREHYP-expected columns           â”‚
â”‚  5. Append to METADATA/METADATA.csv (or create if new)      â”‚
â”‚  6. Check for duplicates (skip if already exists)            â”‚
â”‚                                                              â”‚
â”‚  Output: METADATA/METADATA.csv with new row                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  STEP 2: Update Processing Script                           â”‚
â”‚  Edit process_hyperion.py line 1051:                        â”‚
â”‚  fname = 'EO1H2020342013284110KF'                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  STEP 3: Run Processing                                      â”‚
â”‚  Run: python process_hyperion.py                            â”‚
â”‚                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ STAGE 1: Preprocess Radiance (15-20 min)             â”‚  â”‚
â”‚  â”‚                                                       â”‚  â”‚
â”‚  â”‚ Reads METADATA.csv â†’ Gets sun/satellite angles       â”‚  â”‚
â”‚  â”‚ Reads .MET file â†’ Gets corner coordinates            â”‚  â”‚
â”‚  â”‚                                                       â”‚  â”‚
â”‚  â”‚ â€¢ Concatenate L1T bands (from ZIP)                   â”‚  â”‚
â”‚  â”‚ â€¢ Read L1R radiance (from extracted folder)          â”‚  â”‚
â”‚  â”‚ â€¢ Separate VNIR (bands 7-56) / SWIR (77-223)        â”‚  â”‚
â”‚  â”‚ â€¢ DN to radiance (Ã—40 VNIR, Ã—80 SWIR)               â”‚  â”‚
â”‚  â”‚ â€¢ Desmiling (correct wavelength shifts)              â”‚  â”‚
â”‚  â”‚ â€¢ Destriping (remove detector artifacts)             â”‚  â”‚
â”‚  â”‚ â€¢ Georeference using L1T                             â”‚  â”‚
â”‚  â”‚                                                       â”‚  â”‚
â”‚  â”‚ Output: EO1H2020342013284110KF_preprocessed.img      â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                            â†“                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ STAGE 2: Atmospheric Correction (10-15 min)          â”‚  â”‚
â”‚  â”‚                                                       â”‚  â”‚
â”‚  â”‚ Uses METADATA.csv for sun/look angles                â”‚  â”‚
â”‚  â”‚ Uses .MET for corner coords â†’ DEM download           â”‚  â”‚
â”‚  â”‚                                                       â”‚  â”‚
â”‚  â”‚ â€¢ Download SRTM DEM from Google Earth Engine         â”‚  â”‚
â”‚  â”‚ â€¢ Reproject & resample DEM to match image            â”‚  â”‚
â”‚  â”‚ â€¢ Extract elevation, slope, aspect                    â”‚  â”‚
â”‚  â”‚ â€¢ Dark object subtraction (haze removal)              â”‚  â”‚
â”‚  â”‚ â€¢ Cirrus cloud removal (1.38 Î¼m band)                â”‚  â”‚
â”‚  â”‚ â€¢ Get atmospheric parameters (H2O, O3)                â”‚  â”‚
â”‚  â”‚ â€¢ Run SMARTS radiative transfer                       â”‚  â”‚
â”‚  â”‚ â€¢ Convert radiance â†’ reflectance                      â”‚  â”‚
â”‚  â”‚ â€¢ Topographic correction (if enabled)                 â”‚  â”‚
â”‚  â”‚                                                       â”‚  â”‚
â”‚  â”‚ Output: EO1H2020342013284110KF_reflectance.img       â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                            â†“                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ STAGE 3: Post-processing (2-5 min)                   â”‚  â”‚
â”‚  â”‚                                                       â”‚  â”‚
â”‚  â”‚ â€¢ RGB quicklook (660, 550, 480 nm)                   â”‚  â”‚
â”‚  â”‚ â€¢ False color (NIR-R-G)                              â”‚  â”‚
â”‚  â”‚ â€¢ NDVI computation                                    â”‚  â”‚
â”‚  â”‚ â€¢ Sample spectra plots                                â”‚  â”‚
â”‚  â”‚ â€¢ Statistics summary                                  â”‚  â”‚
â”‚  â”‚                                                       â”‚  â”‚
â”‚  â”‚ Output: Quicklooks PNG + NDVI + statistics           â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  DONE! Check OUT/ folder for results                        â”‚
â”‚  â€¢ EO1H2020342013284110KF_reflectance.img (main product)   â”‚
â”‚  â€¢ quicklooks/ (RGB, false color, NDVI, spectra)           â”‚
â”‚  â€¢ *_statistics.txt                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ” Understanding Metadata Fields

The script extracts these **critical fields** from XML:

| XML Field | CSV Column | Used For | Example Value |
|-----------|------------|----------|---------------|
| Sun Elevation | Sun Elevation | Calculate sun zenith = 90Â° - elevation | 36.752901Â° |
| Sun Azimuth | Sun Azimuth | Solar geometry for shadows | 140.392107Â° |
| Look Angle | Look Angle | Satellite viewing angle | -25.682Â° |
| Satellite Inclination | Satellite Inclination | Satellite orbit angle | 98.0Â° |
| Center Lat/Lon (dec) | Center Latitude dec, Center Longtude dec | DEM download region | 37.555186Â°N, -6.580288Â°W |
| Scene Start/Stop Time | Scene Start Time, Scene Stop Time | Precise acquisition time | 2013:284:10:09:05 |
| Acquisition Date | Acquisition Date | Day-of-year calculation | 2013/10/11 |
| NW/NE/SE/SW corners | [Corner] Lat/Lon dec | Image bounds for DEM | Multiple coordinates |

---

## âš™ï¸ Configuration Options

In `process_hyperion.py`, you can configure:

### Line 1051: Image Name
```python
fname = 'EO1H2020342013284110KF'  # Change for different images
```

### Line 1062: Destriping Method
```python
destripingMethod = 'Pal'  # Options: 'Pal' (recommended), 'Datt', or None
```

### Line 1069: Topographic Correction
```python
use_topo = True  # Set to False to skip (faster but less accurate)
```

### Line 1077: Post-processing
```python
run_postprocessing = True  # Set to False to skip quicklooks
```

### Line 1093: SNAP Compatibility
```python
snap_keep_wavelength = False  # False = safer for SNAP band math
```

---

## ğŸ†˜ Quick Troubleshooting

| Error | Solution |
|-------|----------|
| "Entity ID not found" | Run `create_metadata_*.py` script |
| "L1R folder not found" | Extract `_1R.ZIP` to `L1R/` |
| "L1T ZIP not found" | Keep `_1T.ZIP` in `L1T/` (don't extract) |
| "XML file not found" | Download metadata from EarthExplorer |
| "GEE authentication" | Check GEE_PROJECT_ID in line 993 |
| "SMARTS not found" | Check smartsPath in line 1014 |

---

## ğŸ“ Support

For detailed explanations, see: [WORKFLOW_GUIDE.md](WORKFLOW_GUIDE.md)

For SUREHYP package issues: https://github.com/surehyp/surehyp

---

**Quick Start Created:** 2024-12-02
